---
title: Music Cognition and Memory
format:
  dashboard:
    theme: 
    - superhero
    - styles.scss
    orientation: columns
---

```{r setup}
#| include: false
library(tidyverse)

```

# Introduction

##  Column 1 {width="20%"}

For our research on everyday music listening we decided to investigate the question

How does passive music listening affect performance for people of different levels of music cognition?

We think that it is worth investigating the possibility that people with a high knowledge of music theory might get more or less distracted/affected by the presence of background music when performing a memory task.

To do this we presented all of our subjects with the exact same memory task, except half of them (selected randomly) had to perform the tasks

## Column 2 {width="40%"}

```{r}
#| title: Memory Test Scores dependant on Background Music and Music Proficiency
library(ggplot2)
library(dplyr)

df <- read.csv("qualtrics data.csv")

df <- df %>%
  rename(
    With.music.or.not = Music.Background,
    Memory.Score = Score,
    Total.Gold.MSI.Score = TOTAL.MSI.SCORE
  )

ggplot(df, aes(
  x = Total.Gold.MSI.Score,
  y = Memory.Score,
  color = With.music.or.not
)) +
  geom_point(size = 3, alpha = 0.7) +
  geom_smooth(method = "lm", se = FALSE) +
  scale_color_manual(
    values = c(
      "No" = "#1f77b4",
      "Yes" = "#ff7f0e"
    )
  ) +
  labs(
    title = "Memory Score vs. MSI Score with/without Background Music",
    x = "Total Gold MSI Score",
    y = "Memory Score",
    color = "With Music (Yes or No)"
  ) +
  theme_minimal()
```
# Testing correlation between MSI score and Memory Score, then using p-value to check whether such correlation is significant

	Pearson's product-moment correlation

t = 0.70209, df = 48, p-value = 0.486
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.1826516  0.3688193
sample estimates:
     cor 
0.100822 

## Column 3 {width="40%"}

### Row 1
```{r}
#| title: Boxplot of Memory Scores based on with/without Background Music
library(dplyr)
library(ggplot2)

df <- df %>%
  mutate(With.music.or.not = factor(With.music.or.not, levels = c("No", "Yes")))

stats <- df %>%
  group_by(With.music.or.not) %>%
  summarise(
    Q1 = quantile(Memory.Score, 0.25),
    Q3 = quantile(Memory.Score, 0.75),
    IQR = Q3 - Q1,
    lower = max(min(Memory.Score), Q1 - 1.5 * IQR),
    upper = min(max(Memory.Score), Q3 + 1.5 * IQR),
    mean = mean(Memory.Score),
    median = median(Memory.Score),
    min = min(Memory.Score),
    max = max(Memory.Score),
    xpos = as.numeric(With.music.or.not),
    .groups = "drop"
  )

ggplot(df, aes(
  x = With.music.or.not,
  y = Memory.Score
)) +
  geom_boxplot(
    width = 0.25,
    outlier.shape = 16,
    outlier.size = 2.5,
    color = "black",
    fill = NA
  ) +
  geom_segment(
    data = stats,
    aes(x = xpos - 0.1, xend = xpos + 0.1, y = lower, yend = lower),
    linewidth = 0.9
  ) +
  geom_segment(
    data = stats,
    aes(x = xpos - 0.1, xend = xpos + 0.1, y = upper, yend = upper),
    linewidth = 0.9
  ) +
  geom_segment(
    data = stats,
    aes(x = xpos - 0.1, xend = xpos + 0.1, y = mean, yend = mean),
    linewidth = 0.8,
    linetype = "dashed"
  ) +
  geom_text(
    data = stats,
    aes(x = xpos + 0.15, y = median, label = paste0("Median: ", round(median, 2))),
    hjust = 0,
    size = 3.5
  ) +
  geom_text(
    data = stats,
    aes(x = xpos + 0.15, y = mean, label = paste0("Mean: ", round(mean, 2))),
    hjust = 0,
    size = 3.5
  ) +
  geom_text(
    data = stats,
    aes(x = xpos + 0.15, y = lower, label = paste0("Min: ", round(min, 2))),
    hjust = 0,
    size = 3.5
  ) +
  geom_text(
    data = stats,
    aes(x = xpos + 0.15, y = upper, label = paste0("Max: ", round(max, 2))),
    hjust = 0,
    size = 3.5
  ) +
  scale_y_continuous(limits = c(0, 22), breaks = seq(0, 20, 2)) +
  labs(
    title = "Score from Memory Test by With Background Music or Not",
    x = "With Background Music or Not",
    y = "Score from Memory Test"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    panel.grid.major.x = element_blank(),
    panel.grid.minor = element_blank(),
    legend.position = "none"
  )
```
## t-test statistic and p-value whether there's significance difference between means of with and without background music
'''
	Welch Two Sample t-test

data:  Memory.Score by With.music.or.not
t = -1.6278, df = 49.576, p-value = 0.1099
alternative hypothesis: true difference in means between group No and group Yes is not equal to 0
95 percent confidence interval:
 -4.2532149  0.4458075
sample estimates:
 mean in group No mean in group Yes 
          12.2963           14.2000 

### Row 2

```{r}
#| title: How does time taken to memorize words impact test score?
# Plot
ggplot(df, aes(
    x = Time,
    y = Memory.Score,
    color = With.music.or.not
)) +
    geom_point(size = 3, alpha = 0.7) +
    geom_smooth(method = "lm", se = FALSE) +
    scale_color_manual(
        values = c(
            "No" = "#1f77b4",   # blue
            "Yes" = "#ff7f0e"   # orange
        )
    ) +
    labs(
        title = "Time (seconds) vs Memory Score by Background Music Condition",
        x = "Time (seconds)",
        y = "Memory Score",
        color = "With Music"
    ) +
    theme_minimal(base_size = 14)
```
# testing whether longer waiting time does significantly influence test score
Call:
lm(formula = Memory.Score ~ Time, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.1883 -2.2006 -0.0195  1.8202 10.0378 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  8.17768    0.98423   8.309 5.56e-11 ***
Time         0.03787    0.00652   5.808 4.35e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 3.362 on 50 degrees of freedom
Multiple R-squared:  0.4028,	Adjusted R-squared:  0.3909 
F-statistic: 33.73 on 1 and 50 DF,  p-value: 4.349e-07

# The Data

# Methodology

# Extras
